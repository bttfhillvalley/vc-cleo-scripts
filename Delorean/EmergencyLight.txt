{$CLEO .s}
{$INCLUDE ../Common/CleoConstants.txt}
0000:
int vehicle
int emergencylight = 0
float x
float y
float z 

0000:
while true 
    wait 10
    if
        not Player.Defined($PLAYER_CHAR)
    then
        continue
    end
    if
        80DD:   not actor $player_actor driving_vehicle_type DELOREAN_MODEL
    then
        continue
    end
    03C1: vehicle = player $PLAYER_CHAR car 
    gosub @CheckKey
    gosub @emergencylight_OFF
end




:CheckKey
wait 0
if and
    is_key_pressed 80 //P
    timera > 500
then
    timera = 0
    // Toggle emergencylight     
    if
        emergencylight == 0
    then
        emergencylight = 1 
        gosub @emergencylight_Up
    else 
        emergencylight = 0
        gosub @emergencylight_Down
    end
end
return

:emergencylight_Down
3F18: set_car vehicle component "overheadconsoleelight" glow 0
3F10: set_car vehicle component "overheadconsoleelight" visible 0  
        for x = 50.0 downto 0.0 step 25.0
3F16: set_car vehicle component "overheadconsoleelighth" angle x 0.0 0.0 //handle
    wait 0
    end
    wait 0  
return


:emergencylight_Up 
        for x = 0.0 to 50.0 step 25.0
3F16: set_car vehicle component "overheadconsoleelighth" angle x 0.0 0.0  //handle
    wait 0
    end
0407: create_coordinate x y z from_car vehicle offset 0.0 -20.0 0.0
3F29: create_light type 1 at x y z dir 0 0 0 range 1 rgb 255 255 255 fog 0
3F10: set_car vehicle component "overheadconsoleelight" visible 1 
3F18: set_car vehicle component "overheadconsoleelight" glow 1 //255         
    wait 0
return  

:emergencylight_OFF
if
emergencylight == 0
then
3F18: set_car vehicle component "overheadconsoleelight" glow 0
3F10: set_car vehicle component "overheadconsoleelight" visible 0  
end
    wait 0  
return






